% %% File input
% disp("Select log file")
% [file, location] = uigetfile('*.txt');
% 
% % Check if file exists
% if isequal(file, 0)
%     disp('No file selected. Exiting...')
%     return
% end
% 
% data = readtable([location, file]);


%% mine
clear
close all

% The below code will all get replaced by actual data
timei = 0;
timef = 10;
x = timei:.01:timef;
data1 = [sin(x) ; cos(x) ; tan(x) ; x/10 ; x.^2/10 ; x.^3/10 ; 0*x + 0.5 ; -x/10];
data2 = data1 - 1;

axis_names = ["Var A", "Var B", "Var C", "Var D", "Var E", "Var F", "Var G", "Var H"];
selected_vars = [1,2,5,6,8];

NUM_VARS = size(selected_vars,2);
axes = zeros(NUM_VARS);

figureColor = [0,0,0];
set(groot,{'DefaultAxesXColor','DefaultAxesYColor','DefaultAxesZColor'},{'w','w','w'})

f1 = figure('color', figureColor);

% Tiled layout
T = tiledlayout(1,3, "TileSpacing", "compact", "Padding", "compact");

% Tile 1: Tiled layout: Graphs of variables
t1 = tiledlayout(T, "vertical", "TileSpacing", "none", "Padding", "compact");
t1.Layout.Tile = 1;
t1.Layout.TileSpan = [1,2];
% Subtiles: Individual graphs of variables
for i = 1:NUM_VARS
    nexttile(t1)
    curr = axes(i);
    hold on
    curr(1) = plot(x, data1(i,:), "Color", [1,0,0]);
    curr(2) = plot(x, data2(i,:), "Color", [0,0.5,1]);
    hold off
    set(gca,'Color', [.1, .1, .1])
    xticks([])
    yticks([])
    ylabel(axis_names(selected_vars(i)))
end
xticks();
xlabel("time (s)")

% Tile 2: Tiled layout: Infobox and map
t2 = tiledlayout(T, 2,1, "TileSpacing", "compact", "Padding", "none");
t2.Layout.Tile = 3;

% Subtile A: Tiled layout: 2 columns for track data of both laps
nexttile(t2, 1, [1,1])
Ax = gca;
Ax.Visible = 0; % Make axes invisible for text display
t2a = tiledlayout(t2, 1,2, "TileSpacing", "none", "Padding", "none");
t2a.Layout.Tile = 1;

% Subsubtile i & ii: Lap data of track 1 & 2
for i = [1,2]
    nexttile(t2a, i, [1,1])
    p = plot(x, 0);

    ax = gca;
    ax.XTick = [];
    ax.YTick = [];
    ax.Color = [.2,.2,.2];
    ax.Box = "on";

    infoBox_string = "Lap " + i + ":\n";
    infoBox_data = zeros(NUM_VARS);
    for j = 1:NUM_VARS
        infoBox_string = infoBox_string + axis_names(selected_vars(j)) + ": " + infoBox_data(j) + "\n";
    end

    xlim(xlim+[-10,10]);ylim(ylim+[-10,10]); % use xlim and ylim to fix location
    text(min(xlim), max(ylim), sprintf(infoBox_string), 'Horiz','left', 'Vert','top', ...
        "Color", "w", 'fontsize',3,'fontunits','normalized')

end

% infoBox_str = {['Time: ',num2str(0)], ['Speed: ', num2str(0)], ['Throttle: ', num2str(0)], ['Brake: ', num2str(0)], ['RPM: ', num2str(0)], ['GForce: ', num2str(0)]};
% infoBox_dim = [.915 .375 .75 .2];
% infoBox_color = [1 1 1];
% infoBox = annotation(f1, 'textbox',infoBox_dim,'String',infoBox_str,'FitBoxToText','on', 'color', infoBox_color, 'edgecolor', infoBox_color, 'FontSize', 11);

% Subtile B: Map
nexttile(t2, 2, [1,1])
plot(x, sin(x))



%% old

clear
close all
warning('off','all')

figureColor = [0,0,0];
subplotColor = [0.1,0.1,0.1];
set(groot,{'DefaultAxesXColor','DefaultAxesYColor','DefaultAxesZColor'},{'w','w','w'})

%figure 1
f1 = figure('color', figureColor);
sgtitle("Lap Analysis (1)")
%set(f1, 'WindowButtonDownFcn', @MovingVerticalLine);

axs_length = 5;
axs_width = 4;
axisHeight = 0.18;
%axisPos = [1-axisHeight, 1-(2*(axisHeight-.001)), 1-(3*(axisHeight-.001)), 1-(4*(axisHeight-.001)), 1-(5*(axisHeight-0.001))] - 0.03;
for i = 1:5
    axisPos(i) = 1-i*(0.2-0.03) - 0.03;
end

axs_SPEED = subplot(axs_length,axs_width, 1, 'color', subplotColor, 'Position', [0.03,axisPos(1),0.65,axisHeight]);
xticks([]);
yticks([]);
ylabel("Speed(mph)")


axs_THROTTLE = subplot(axs_length,axs_width, 5, 'color', subplotColor, 'Position', [0.03,axisPos(2),0.65,axisHeight]);
xticks([]);
yticks([]);
ylabel("Throttle Input(percent)")
set(gca, 'YGrid', 'on', 'XGrid', 'off');

axs_BRAKE = subplot(axs_length,axs_width, 9, 'color', subplotColor, 'Position', [0.03,axisPos(3),0.65,axisHeight]);
xticks([]);
yticks([]);
ylabel("Brake Pressure(psi)")
grid on

axs_RPM = subplot(axs_length,axs_width, 13, 'color', subplotColor, 'Position', [0.03,axisPos(4),0.65,axisHeight]);
xticks([])
yticks([]);
ylabel("RPM")
grid on

axs_GFORCE1 = subplot(axs_length,axs_width, 17, 'color', subplotColor, 'Position', [0.03,axisPos(5),0.65,axisHeight]);
xlabel("time (s)")
yticks([]);
ylabel("Cumulative G-Force")
grid on

axs_map = subplot(axs_length,axs_width, [16,20],'color', subplotColor, 'Position', [0.725,.15,0.25,.45]);

axs = [axs_SPEED, axs_THROTTLE, axs_BRAKE, axs_RPM, axs_GFORCE1];

%information readout
infoBox_str = {['Time: ',num2str(0)], ['Speed: ', num2str(0)], ['Throttle: ', num2str(0)], ['Brake: ', num2str(0)], ['RPM: ', num2str(0)], ['GForce: ', num2str(0)]};
infoBox_dim = [.915 .375 .75 .2];
infoBox_color = [1 1 1];
infoBox = annotation(f1, 'textbox',infoBox_dim,'String',infoBox_str,'FitBoxToText','on', 'color', infoBox_color, 'edgecolor', infoBox_color, 'FontSize', 11);

warning('on','all')